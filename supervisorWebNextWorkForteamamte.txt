===========================================
SUPERVISOR WEB DASHBOARD - NEXT WORK FOR TEAMMATE
===========================================

This file tracks new features and updates needed for the Supervisor Web Dashboard.
Update this file whenever backend adds features that need supervisor web UI.

===========================================
CURRENT PENDING WORK
===========================================

PRIORITY: All features below are HIGH PRIORITY for graduation project demo

-------------------------------------------
[NEW] 1. "MY WORKERS" PAGE
-------------------------------------------
Priority: HIGH - Teacher specifically mentioned this
Status: Backend Complete âœ… - Web UI Needed

WHAT IT DOES:
Shows supervisor's assigned workers with their details, performance, and tasks.
Allows supervisor to manage workers and reassign tasks between them.

WHAT TO BUILD:
--------------

A. CREATE "MY WORKERS" PAGE

Location: New page in Supervisor Dashboard

Display List Showing:
â–¡ Worker cards (expandable/collapsible)
â–¡ Worker Name + Department + Zone
â–¡ Current Status (Active/Checked In or Offline)
â–¡ Current Tasks count (e.g., "3 active, 12 completed this week")
â–¡ When expanded, show:
  - Worker's profile info (what supervisor should see)
  - List of current tasks assigned to this worker
  - Performance metrics (completion rate, avg time per task)
  - Button: "View Full Profile"
  - Button: "Reassign Task" for each task

B. IMPLEMENT TASK REASSIGNMENT

When Supervisor Clicks "Reassign Task":
1. Show dialog with:
   - Current task details
   - Dropdown to select new worker (from supervisor's workers)
   - Optional text field: "Reason for reassignment"
   - Confirm/Cancel buttons

2. On Confirm:
   - Call API: PUT /api/tasks/{id}/reassign
   - Request body:
     {
       "newAssignedToUserId": 123,
       "reassignmentReason": "string (optional)"
     }

3. On Success:
   - Show success message
   - Refresh worker's task list

C. BACKEND API (âœ… Already Implemented!)

1. âœ… GET /api/users/my-workers
   - Returns list of workers assigned to current supervisor
   - Response:
     [
       {
         "userId": 1,
         "fullName": "Ù…Ø­Ù…Ø¯ Ø£Ø­Ù…Ø¯",
         "department": "Ø§Ù„Ù†Ø¸Ø§ÙØ©",
         "workerType": "Cleaner",
         "isActive": true,
         "lastCheckIn": "2026-01-19T08:00:00Z",
         "activeTasksCount": 3,
         "completedTasksThisWeek": 12,
         "completionRate": 95.5,
         "warningCount": 0,
         "lastBatteryLevel": 85,
         "isLowBattery": false
       }
     ]

2. âœ… GET /api/users/{id}/profile
   - Returns detailed worker profile
   - Includes: personal info, assigned zones, current tasks, performance stats,
     recent attendance (last 7 days), recent tasks (last 10)

3. âœ… PUT /api/tasks/{id}/reassign
   - Reassigns task to different worker
   - Request body:
     {
       "newAssignedToUserId": 123,
       "reassignmentReason": "optional"
     }
   - Sends notifications to both old and new workers

D. UI/UX GUIDELINES

Layout:
- Use expandable cards (collapsed by default)
- Show worker status with colored indicator (green=active, gray=offline)
- Display task count prominently

Arabic Text:
- Page Title: "Ø¹Ù…Ø§Ù„ÙŠ" or "Ø§Ù„Ø¹Ù…Ø§Ù„ Ø§Ù„ØªØ§Ø¨Ø¹ÙŠÙ† Ù„ÙŠ"
- Status: "Ù†Ø´Ø·" / "ØºÙŠØ± Ù…ØªØµÙ„"
- Button: "Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù…Ù‡Ù…Ø©"
- Button: "Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù„Ù Ø§Ù„ÙƒØ§Ù…Ù„"

E. IMPORTANT NOTES

1. **Filtering:**
   - Must show only workers assigned to current supervisor
   - Use SupervisorId relationship in User table

2. **Real-time Status:**
   - Worker is "active" if checked in today
   - Consider showing last check-in time

3. **Performance Metrics:**
   - Calculate completion rate, avg time per task
   - Can be computed on-demand or cached

-------------------------------------------
[NEW] 2. CREATE TASK WITH MAP (PIN SELECTION)
-------------------------------------------
Priority: HIGH - Teacher specifically mentioned this
Status: Partially Done - Backend fields exist, Web UI Needed

WHAT IT DOES:
When creating a task, supervisor selects precise location by placing a pin on a map.
This pin location will be used for GPS validation when worker completes the task.

WHAT TO BUILD:
--------------

A. ENHANCE "CREATE TASK" PAGE

Current State:
âœ… Form with title, description, due date
âœ… Zone selection dropdown
âŒ No map for precise location
âŒ No shared task support

Add To Form:
â–¡ Interactive map (after zone selection)
â–¡ Map centers on selected zone
â–¡ Search box on map (e.g., "Ø³ÙˆØ¨Ø± Ù…Ø§Ø±ÙƒØª Ø³Ø§Ù„Ù…")
â–¡ Click on map to place pin
â–¡ Display selected coordinates (latitude, longitude)
â–¡ Radio buttons: "ÙØ±Ø¯ÙŠØ©" (Individual) or "Ù…Ø´ØªØ±ÙƒØ©" (Shared)
â–¡ If shared: Multi-select dropdown for workers

B. MAP IMPLEMENTATION

Use React Leaflet or similar library:

1. When supervisor selects zone:
   - Map centers on zone coordinates
   - Zoom level: 15

2. Search functionality:
   - Use Nominatim API for geocoding
   - Restrict search to selected zone bounds
   - When result found, move map to that location

3. Pin placement:
   - Click anywhere on map to place pin
   - Only one pin at a time (clicking again moves pin)
   - Show pin marker clearly

4. Coordinates display:
   - Show latitude/longitude below map
   - Format: "31.905, 35.215"

C. BACKEND API UPDATES NEEDED

1. Modify POST /api/tasks
   - Already accepts latitude/longitude (âœ… Backend fields exist)
   - Add support for:
     {
       "title": "...",
       "description": "...",
       "assignedToUserId": 123,  // if individual
       "assignedUserIds": [1, 2, 3],  // if shared (NEEDS IMPLEMENTATION)
       "isShared": true/false,  // NEEDS IMPLEMENTATION
       "latitude": 31.905,  // âœ… Already exists
       "longitude": 35.215,  // âœ… Already exists
       "zoneId": 1,
       "dueDate": "..."
     }

2. For shared tasks:
   - Need to support multiple workers on same task
   - This is COMPLEX - may need new TaskAssignment table
   - OPTIONAL for now, focus on individual tasks first

D. UI/UX GUIDELINES

Form Layout:
1. Basic Info (title, description, priority)
2. Zone Selection
3. Map Section (appears after zone selected)
   - Search box above map
   - Interactive map (400px height)
   - Coordinates display below map
4. Assignment (individual/shared radio buttons)
5. Due Date
6. Submit button

Arabic Text:
- Section: "ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¯Ù‚ÙŠÙ‚"
- Search: "Ø§Ø¨Ø­Ø« Ø¹Ù† Ù…ÙˆÙ‚Ø¹..."
- Coordinates: "Ø§Ù„Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª"
- Individual: "Ù…Ù‡Ù…Ø© ÙØ±Ø¯ÙŠØ©"
- Shared: "Ù…Ù‡Ù…Ø© Ù…Ø´ØªØ±ÙƒØ©"

E. IMPORTANT NOTES

1. **Zone First, Then Pin:**
   - Zone narrows down the area
   - Pin gives exact location within zone

2. **Backend Fields Ready:**
   - Task.Latitude and Task.Longitude already exist (âœ…)
   - Just need to send from frontend

3. **Shared Tasks (Optional):**
   - Complex feature requiring database changes
   - Can postpone if time limited
   - Focus on individual tasks first

-------------------------------------------
[NEW] 3. TASK DETAILS PAGE ENHANCEMENT
-------------------------------------------
Priority: HIGH - Important for demo
Status: Basic page exists - Needs enhancements

WHAT IT DOES:
When supervisor clicks on a task, show complete details including:
- Map with pin showing exact location
- Progress bar
- Uploaded photos (if completed)
- Distance from task location (if rejected)
- Appeal status (if rejected)

WHAT TO BUILD:
--------------

A. ENHANCE EXISTING TaskDetails.tsx

Current State:
âœ… Basic task info displayed
âŒ No map
âŒ No progress display
âŒ No photos display
âŒ No location verification details

Add to Page:
â–¡ Map showing task pin location (not editable, just display)
â–¡ Progress bar with percentage
â–¡ Photos section (shows photos if task completed)
â–¡ If task rejected:
  - Show rejection reason
  - Show distance from location
  - Show appeal status
  - Button to approve override (if auto-rejected)

B. LAYOUT DESIGN

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â† Back  |  ğŸ“‹ Task Details          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Title: ØªÙ†Ø¸ÙŠÙ Ø´Ø§Ø±Ø¹ Ø§Ù„Ø³Ù„Ø§Ù…             â”‚
â”‚ Description: ...                    â”‚
â”‚                                     â”‚
â”‚ ğŸ‘¤ Worker: Ù…Ø­Ù…Ø¯ Ø£Ø­Ù…Ø¯               â”‚
â”‚ ğŸ“ Zone: Ø¬Ø¨Ù„ Ø§Ù„Ø·ÙˆÙŠÙ„                â”‚
â”‚                                     â”‚
â”‚ ğŸ—ºï¸ Precise Location:               â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚ â”‚  [Map Display]  â”‚                 â”‚
â”‚ â”‚      ğŸ“        â”‚                 â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚                                     â”‚
â”‚ â±ï¸ Progress: 80%                    â”‚
â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘                     â”‚
â”‚                                     â”‚
â”‚ ğŸ“… Created: Jan 16                  â”‚
â”‚ ğŸ“… Due: Jan 17                      â”‚
â”‚ ğŸ“Š Status: In Progress              â”‚
â”‚                                     â”‚
â”‚ ğŸ“· Photos: (if completed)           â”‚
â”‚ [Thumbnails clickable to enlarge]   â”‚
â”‚                                     â”‚
â”‚ [Edit Task] [Reassign] [Cancel]     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

C. BACKEND API (Already Exists)

GET /api/tasks/{id}
- Returns complete task details
- Already includes:
  âœ… Latitude/Longitude
  âœ… ProgressPercentage
  âœ… Photos array
  âœ… Status
  âœ… IsAutoRejected, RejectionReason

No backend changes needed - just display the data!

D. UI/UX GUIDELINES

Map Display:
- Read-only (supervisor can't move pin)
- Center on task location
- Zoom level: 16
- Single marker at task location

Progress Display:
- Show percentage number
- Visual progress bar
- Use color: green if >70%, yellow if 30-70%, red if <30%

Photos Display:
- Grid layout (2-3 columns)
- Thumbnails clickable to view full size
- Show "No photos yet" if task not completed

Arabic Text:
- Section: "Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¯Ù‚ÙŠÙ‚"
- Progress: "Ø§Ù„ØªÙ‚Ø¯Ù…"
- Photos: "Ø§Ù„ØµÙˆØ± Ø§Ù„Ù…Ø±ÙÙ‚Ø©"

-------------------------------------------
[NEW] 4. LOCATION HISTORY PAGE
-------------------------------------------
Priority: HIGH - Teacher specifically mentioned this for presentation
Status: Backend exists - Web UI Needed

WHAT IT DOES:
Shows worker's movement history on a map as a polyline (path).
Supervisor can select worker and date to see where they went during that day.
Important for demos and presentations to committee!

WHAT TO BUILD:
--------------

A. CREATE "LOCATION HISTORY" PAGE

Location: New page in Supervisor Dashboard

Display Components:
â–¡ Worker selection dropdown (supervisor's workers only)
â–¡ Date picker
â–¡ "Show" button
â–¡ Map showing:
  - Polyline connecting location points
  - Small markers at each point
  - Different colors for different time periods (morning/afternoon/evening)
â–¡ Statistics section:
  - Total distance traveled
  - Active time
  - Number of location points recorded

B. MAP VISUALIZATION

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“ Location History                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Worker: [â–¼ Ù…Ø­Ù…Ø¯ Ø£Ø­Ù…Ø¯]              â”‚
â”‚ Date: [ğŸ“… 18/01/2026]               â”‚
â”‚ [Show Button]                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ—ºï¸ Map:                             â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚                               â”‚   â”‚
â”‚ â”‚    08:00 â—â”€â”€â”€â”€â—â”€â”€â”€â”€â—          â”‚   â”‚
â”‚ â”‚          â”‚    â”‚    â”‚          â”‚   â”‚
â”‚ â”‚         09:00 â”‚   10:00       â”‚   â”‚
â”‚ â”‚              11:00            â”‚   â”‚
â”‚ â”‚                               â”‚   â”‚
â”‚ â”‚  Blue polyline shows path     â”‚   â”‚
â”‚ â”‚  Small circles are GPS points â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”‚ ğŸ“Š Statistics:                      â”‚
â”‚ â€¢ Distance: 12.5 km                 â”‚
â”‚ â€¢ Active Time: 7 hours              â”‚
â”‚ â€¢ Points Recorded: 840              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

C. BACKEND API (Already Exists!)

GET /api/tracking/history
Query Parameters:
  - userId (required)
  - date (required) - format: YYYY-MM-DD

Response:
[
  {
    "latitude": 31.905,
    "longitude": 35.215,
    "recordedAt": "2026-01-18T08:00:00Z"
  },
  {
    "latitude": 31.906,
    "longitude": 35.216,
    "recordedAt": "2026-01-18T08:00:30Z"
  }
  // ... every 30 seconds
]

âœ… API already exists in TrackingController
âœ… LocationHistory table already stores data
No backend changes needed!

D. IMPLEMENTATION DETAILS

Use React Leaflet:
- Polyline component to connect points
- CircleMarker for each location point
- Different polyline colors for time of day:
  - Morning (6am-12pm): Blue
  - Afternoon (12pm-6pm): Orange
  - Evening (6pm-12am): Purple

Calculate statistics:
- Distance: Sum of distances between consecutive points using Haversine formula
- Active time: Time between first and last point
- Points: Array length

E. UI/UX GUIDELINES

Worker Dropdown:
- Shows only supervisor's workers
- Sorted alphabetically

Date Picker:
- Default to today
- Disable future dates
- Show calendar widget

Map:
- Height: 500px
- Zoom to fit all points (auto-bounds)
- Make polyline thick (3-4px) and colored

Arabic Text:
- Page: "Ø³Ø¬Ù„ Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹" or "ØªØªØ¨Ø¹ Ø§Ù„Ø­Ø±ÙƒØ©"
- Worker: "Ø§Ù„Ø¹Ø§Ù…Ù„"
- Date: "Ø§Ù„ØªØ§Ø±ÙŠØ®"
- Statistics: "Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª"
- Distance: "Ø§Ù„Ù…Ø³Ø§ÙØ© Ø§Ù„Ù…Ù‚Ø·ÙˆØ¹Ø©"
- Active Time: "Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù†Ø´Ø·"

F. IMPORTANT NOTES

1. **For Committee Presentation:**
   - This feature impresses evaluators!
   - Shows technical sophistication
   - Teacher mentioned this specifically

2. **Data Already Stored:**
   - GPS tracking runs every 30 seconds
   - All data saved in LocationHistory table
   - Just need to display it!

3. **Performance:**
   - One day typically = ~1000 points (if 8 hours Ã— 120 points/hour)
   - Should load fast enough
   - If slow, add loading indicator

-------------------------------------------
[NEW] 5. PROGRESS BARS IN TASK LISTS
-------------------------------------------
Priority: MEDIUM - Visual enhancement
Status: Backend field exists - Frontend display needed

WHAT IT DOES:
Shows progress bar for each task in task lists (dashboard and tasks page).
Visual indicator of how much work is done on each task.

WHAT TO BUILD:
--------------

A. ADD TO TASK CARDS/ROWS

Current Display:
âœ… Task title
âœ… Worker name
âœ… Due date
âœ… Status badge
âŒ No progress indicator

Add:
â–¡ Progress bar below task title
â–¡ Percentage text (e.g., "80%")
â–¡ Color coding:
  - Green: >70%
  - Yellow: 30-70%
  - Red: <30%
  - Gray: Not started (0%)

B. VISUAL DESIGN

Task Card Before:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ”´ ØªÙ†Ø¸ÙŠÙ Ø´Ø§Ø±Ø¹ Ø§Ù„Ø³Ù„Ø§Ù…            â”‚
â”‚ Worker: Ù…Ø­Ù…Ø¯ Ø£Ø­Ù…Ø¯               â”‚
â”‚ Due: Jan 17 (Delayed!)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Task Card After:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ”´ ØªÙ†Ø¸ÙŠÙ Ø´Ø§Ø±Ø¹ Ø§Ù„Ø³Ù„Ø§Ù…            â”‚
â”‚ Progress: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘ 80%         â”‚
â”‚ Worker: Ù…Ø­Ù…Ø¯ Ø£Ø­Ù…Ø¯               â”‚
â”‚ Due: Jan 17 (Delayed!)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

C. IMPLEMENTATION

Backend:
âœ… Task.ProgressPercentage field already exists
No backend changes needed!

Frontend:
- Read progressPercentage from task object
- Display using <progress> element or CSS bar
- Show percentage text next to bar

Example React Code:
```tsx
<div className="progress-bar">
  <div
    className="progress-fill"
    style={{
      width: `${task.progressPercentage}%`,
      backgroundColor: getProgressColor(task.progressPercentage)
    }}
  />
  <span>{task.progressPercentage}%</span>
</div>
```

D. IMPORTANT NOTES

1. **Simple Enhancement:**
   - Backend ready
   - Just display existing data

2. **Where to Show:**
   - Dashboard task list
   - Main tasks page
   - My Workers page (in worker's task list)

-------------------------------------------
[NEW] 6. APPROVE REJECTED TASKS FEATURE
-------------------------------------------
Priority: HIGH
Status: Backend Complete - Web UI Needed
Backend Endpoint: PUT /api/tasks/{id}/approve-override

WHAT IT DOES:
When workers complete tasks but have GPS problems (distance > 500m), tasks get
auto-rejected after 2 failed attempts. This feature lets supervisors review the
photo evidence and approve the task if the worker actually did the work.

WHAT TO BUILD:
--------------

A. ADD "AUTO-REJECTED TASKS" SECTION TO DASHBOARD

Location: Supervisor Dashboard / Rejected Tasks Tab

Display List Showing:
â–¡ Task ID & Title
â–¡ Worker Name
â–¡ Rejection Date & Time
â–¡ Rejection Reason (with distance)
â–¡ Task Location (coordinates)
â–¡ Photo Evidence (thumbnail - clickable to view full size)
â–¡ Worker's Completion Notes
â–¡ Action Button: "Approve Override" (Arabic: "Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²")

Filter Options:
â–¡ Show only Auto-Rejected tasks (IsAutoRejected = true)
â–¡ Sort by rejection date (newest first)
â–¡ Search by worker name or task title

B. IMPLEMENT "APPROVE OVERRIDE" FUNCTIONALITY

When Supervisor Clicks "Approve Override":
1. Show confirmation dialog with:
   - Task details
   - Photo preview
   - Distance from location
   - Optional text field: "Supervisor Notes" (Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„Ù…Ø´Ø±Ù)
   - Confirm/Cancel buttons

2. On Confirm:
   - Call API: PUT /api/tasks/{id}/approve-override
   - Request body (optional):
     {
       "supervisorNotes": "string (optional)"
     }

3. On Success:
   - Show success message: "ØªÙ…Øª Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù‡Ù…Ø©"
   - Remove task from rejected list
   - Refresh dashboard

4. On Error:
   - Show error message from API

C. API INTEGRATION DETAILS

Endpoint: PUT /api/tasks/{id}/approve-override
Authorization: Bearer Token (Supervisor or Admin role)
Headers:
  - Authorization: Bearer {token}
  - Content-Type: application/json

Request Body (optional):
{
  "supervisorNotes": "Ø§Ù„Ø¹Ø§Ù…Ù„ Ø£Ù†Ø¬Ø² Ø§Ù„Ù…Ù‡Ù…Ø© ÙØ¹Ù„ÙŠØ§Ù‹ØŒ Ø§Ù„Ù…Ø´ÙƒÙ„Ø© ÙƒØ§Ù†Øª ÙÙŠ Ø¯Ù‚Ø© GPS"
}

Success Response (200 OK):
{
  "success": true,
  "data": {
    // TaskResponse object (task now shows as Completed)
  },
  "message": "ØªÙ…Øª Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù‡Ù…Ø©. ØªÙ… ØªÙ‚Ù„ÙŠÙ„ Ø¹Ø¯Ø¯ Ø§Ù„ØªØ­Ø°ÙŠØ±Ø§Øª Ù„Ù„Ø¹Ø§Ù…Ù„."
}

Error Responses:
- 404: Task not found
- 400: Task is not rejected
- 400: Task was manually rejected (use reset instead)
- 401: Unauthorized

D. UI/UX GUIDELINES

Colors:
- Use green/success color for approve button
- Show photo in modal/lightbox when clicked
- Highlight distance in red if > 500m

Arabic Text:
- Section Title: "Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ù…Ø±ÙÙˆØ¶Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹"
- Button: "Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²"
- Confirmation: "Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ù‡Ø°Ù‡ Ø§Ù„Ù…Ù‡Ù…Ø©ØŸ"
- Success: "ØªÙ…Øª Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù‡Ù…Ø© Ø¨Ù†Ø¬Ø§Ø­"
- Notes Field: "Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„Ù…Ø´Ø±Ù (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)"

E. IMPORTANT NOTES

1. **Only Auto-Rejected Tasks:**
   - Filter: IsAutoRejected = true
   - Manual rejections should use the existing "Reset" feature

2. **Photo Evidence is Key:**
   - Photos are now saved even on rejection (new backend fix)
   - Make photo prominent in UI so supervisor can make informed decision

3. **Fair Process:**
   - This feature supports fairness to workers
   - System rejects automatically, but supervisor is the final judge
   - Emphasize in UI that this is for GPS issues, not cheating

4. **Warning Count Reduction:**
   - Backend automatically reduces worker's warning count when approved
   - No need to show this explicitly, but good to know

-------------------------------------------
[NEW] 7. APPEALS MANAGEMENT (SUPERVISOR VIEW)
-------------------------------------------
Priority: MEDIUM
Status: Backend Complete âœ… - Web UI Needed

WHAT IT DOES:
Workers can submit appeals against auto-rejected tasks. Supervisors can
review these appeals and approve/reject them.

WHAT TO BUILD:
--------------

A. CREATE "APPEALS" SECTION/PAGE

Location: Supervisor Dashboard or separate page

Display List Showing:
â–¡ Appeal ID
â–¡ Worker Name
â–¡ Task Title
â–¡ Appeal Date
â–¡ Worker's Explanation
â–¡ Evidence Photo (if provided)
â–¡ Status (Pending/Approved/Rejected)
â–¡ Action Buttons: "Approve" / "Reject"

B. BACKEND API (âœ… Already Implemented!)

1. âœ… GET /api/appeals/pending
   - Returns list of pending appeals for supervisor's workers
   - Response includes: appealId, workerName, taskTitle, explanation, evidencePhotoUrl

2. âœ… POST /api/appeals/{id}/review
   - Approve or reject an appeal
   - Request body:
     {
       "approved": true/false,
       "reviewNotes": "optional notes"
     }

C. UI/UX GUIDELINES

Arabic Text:
- Page Title: "Ø§Ù„Ø·Ø¹ÙˆÙ†" or "Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©"
- Approve: "Ù‚Ø¨ÙˆÙ„ Ø§Ù„Ø·Ø¹Ù†"
- Reject: "Ø±ÙØ¶ Ø§Ù„Ø·Ø¹Ù†"
- Notes: "Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©"

-------------------------------------------
FUTURE ENHANCEMENTS (Lower Priority - Can Postpone)
-------------------------------------------

â–¡ APPROVE REJECTED TASKS - Additional Features:
  - Statistics: Show count of auto-rejected tasks awaiting review
  - Batch Operations: Approve multiple tasks at once
  - Notifications: Notify supervisor when task gets auto-rejected

â–¡ SHARED TASKS:
  - Support multiple workers on same task
  - Requires database changes (TaskAssignment table)
  - Complex feature - postpone if time limited

â–¡ ROUTINE TASKS SYSTEM:
  - Create task templates
  - Auto-assign daily/weekly tasks
  - Requires backend cron job
  - Lower priority for graduation demo

â–¡ BATTERY ALERTS PAGE:
  - Display low battery alerts from workers
  - Backend endpoint exists: POST /api/users/battery-report âœ…
  - Shows workers with battery < 20%
  - Can add to My Workers page or separate section

===========================================
COMPLETED WORK
===========================================

When features are completed, move them here with completion date.

Example:
[âœ… DONE - Jan 19, 2026] Feature Name
- Brief description of what was implemented
- Link to PR or commit if applicable

-------------------------------------------
[âœ… PARTIAL] Basic Supervisor Pages
-------------------------------------------
Date: Already exists

Completed:
âœ… Dashboard.tsx - Basic overview stats
âœ… Tasks.tsx - Task list (no progress bars yet)
âœ… TaskDetails.tsx - Basic details with approve/reject
âœ… CreateTask.tsx - Form works (no map yet)
âœ… Issues.tsx - Full functionality
âœ… IssueDetails.tsx - Convert to task works

Still Needed:
âŒ My Workers page
âŒ Location History page
âŒ Map in CreateTask
âŒ Progress bars in task lists
âŒ Photos display in TaskDetails

===========================================
HOW TO UPDATE THIS FILE
===========================================

When backend adds new features for supervisor web:
1. Add new section under "CURRENT PENDING WORK"
2. Include: Description, API endpoints, UI requirements
3. When teammate completes it, move to "COMPLETED WORK" section

===========================================
QUESTIONS?
===========================================

If anything is unclear about the requirements or API:
- Check teacher's requirements: Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ù…Ø±Ø§Ø¯.md
- Check implementation assessment: IMPLEMENTATION_ASSESSMENT.md
- Check requirements checklist: REQUIREMENTS_CHECKLIST.md
- Check backend documentation: TWO_ATTEMPT_SYSTEM.md
- Check backend code: backend/FollowUp.API/Controllers/
- Ask for clarification!

===========================================
SUMMARY - WHAT NEEDS TO BE BUILT
===========================================

BACKEND APIS STATUS:
1. âœ… GET /api/users/my-workers (for My Workers page) - DONE!
2. âœ… GET /api/users/{id}/profile (for worker details) - DONE!
3. âœ… PUT /api/tasks/{id}/reassign (for task reassignment) - DONE!
4. âœ… PUT /api/tasks/{id}/approve-override - DONE!
5. âœ… GET /api/tracking/history - DONE!
6. âœ… GET /api/appeals/pending - DONE!
7. âœ… POST /api/appeals/{id}/review - DONE!
8. âœ… POST /api/users/battery-report - DONE!

ALL BACKEND APIs ARE READY! Just need frontend implementation.

FRONTEND PAGES NEEDED:
1. My Workers Page (NEW - most important!)
2. Location History Page (NEW - impressive for demo!)
3. Enhance: Create Task page (add map with pin selection)
4. Enhance: Task Details page (add map, progress, photos display)
5. Enhance: Task Lists (add progress bars)
6. Enhance: Dashboard (add auto-rejected tasks section)
7. Appeals Management (NEW or integrate with dashboard)

PRIORITY ORDER FOR IMPLEMENTATION:
1. My Workers Page (HIGH - teacher mentioned specifically)
2. Create Task with Map (HIGH - needed for GPS validation)
3. Task Details Enhancement (HIGH - for demo)
4. Location History Page (HIGH - impressive for committee)
5. Progress Bars (MEDIUM - visual enhancement)
6. Approve Override UI (MEDIUM - backend ready)
7. Appeals Management (MEDIUM - backend ready)

===========================================
LAST UPDATED: 2026-01-20
===========================================
